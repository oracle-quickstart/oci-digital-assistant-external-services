# Copyright (c) 2020 Oracle and/or its affiliates. All rights reserved.
# Licensed under the Universal Permissive License v 1.0 as shown at http://oss.oracle.com/licenses/upl.
#

title: Digital Assistant External Services
description: Digital Assistant External Services
informationalText: "This stack provision and configure the infrastructure that you need to deploy Digital Assistant custom components/webviews to Oracle Kubernetes Engine (OKE). You also can use this infrastructure to deploy different utility services that Digital Assistant can benefit from, like custom channel webhook implementations."
schemaVersion: 1.1.0
version: "20190304"
locale: "en"

variableGroups:
  - title: "Hidden"
    variables:
      - compartment_ocid
      - tenancy_ocid
      - user_ocid
      - region
      - fingerprint
      - private_key_path
      - oke-worker-node-shape
      - network_cidrs
      - network_names
    visible: false

  - title: "OKE Configurations"
    variables:
      - oke-cluster-name
      - oke-worker-node-shape
      - oke-worker-node-ocpu
      - oke-worker-node-memory
      - apigateway_name
      - provision_vault
      - vault_name

variables:
  oke-cluster-name:
    type: string
    title: "Cluster Name"
    default: "Digital Assistant OKE Cluster"
    required: true
    visibe: true

  oke-worker-node-shape:
    type: oci:core:instanceshape:name
    default: "VM.Standard.E3.Flex"
    title: "Worker Nodes Compute Shape"
    visible: true
    required: true
    dependsOn:
      compartmentId: ${compartment_ocid}

  oke-worker-node-ocpu:
    type: integer
    default: 1
    minimum: 1
    maximum: 64
    title: "Number of OCPUs"
    visible:
      or:
        - eq:
            - oke-worker-node-shape
            - "VM.Standard.E3.Flex"
        - eq:
            - oke-worker-node-shape
            - "VM.Standard.E4.Flex"

  oke-worker-node-memory:
    type: integer
    default: 32
    minimum: 1
    maximum: 1024
    title: "Amount of memory (GB)"
    visible:
      or:
        - eq:
            - oke-worker-node-shape
            - "VM.Standard.E3.Flex"
        - eq:
            - oke-worker-node-shape
            - "VM.Standard.E4.Flex"

  apigateway_name:
    type: string
    title: "API Gateway Name"
    required: true
    default: "Digital Assistant API Gateway"

  provision_vault:
    type: boolean
    title: "Enable Vault Support ?"
    description: "Create a vault and master encryption key that you manage and can use to encrypt and store credentials."
    required: true
    default: true

  vault_name:
    type: string
    title: "Name of the Vault to provision"
    default: "Digital Assistant Vault"
    required: true
    visible: provision_vault